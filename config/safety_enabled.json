{
  "_comment": "Multi-objective SFT config with Safety KL enabled (requires higher VRAM)",
  "model": {
    "base_model_id": "Qwen/Qwen2.5-3B-Instruct",
    "tokenizer_id": null,
    "max_seq_len": 1024
  },
  "quant": {
    "load_in_4bit": true,
    "bnb_4bit_quant_type": "nf4",
    "bnb_4bit_use_double_quant": true,
    "bnb_4bit_compute_dtype": "float16"
  },
  "lora": {
    "r": 16,
    "alpha": 32,
    "dropout": 0.05,
    "target_modules": []
  },
  "datasets": {
    "mixture_alpha": 0.5,
    "max_train_examples": 5000,
    "max_eval_examples": 64
  },
  "train": {
    "seed": 7,
    "max_train_steps": 200,
    "learning_rate": 0.0002,
    "warmup_ratio": 0.03,
    "per_device_train_batch_size": 1,
    "gradient_accumulation_steps": 8,
    "per_device_eval_batch_size": 1,
    "logging_steps": 10,
    "eval_steps": 100,
    "save_steps": 100,
    "max_grad_norm": 1.0,
    "gradient_checkpointing": true,
    "output_dir": null
  },
  "losses": {
    "_comment": "Multi-objective loss: L = λ_LM*NLL + λ_emo*Emo + λ_strat*Strat + λ_val*Val + λ_safe*Safe",
    "lambda_lm": 1.0,
    "lambda_emo": 0.2,
    "lambda_strat": 0.2,
    "lambda_val": 0.0,
    "lambda_safe": 0.1
  },
  "safety": {
    "_comment": "Safety teacher KL: L_safe = KL(σ(z_T/τ) || σ(z_θ/τ))",
    "enabled": true,
    "teacher_model_id": "",
    "temperature_tau": 2.0,
    "teacher_subset_ratio": 0.1
  },
  "dpo": {
    "enabled": false,
    "beta": 0.1,
    "lambda_violation": 0.0
  },
  "generation": {
    "max_new_tokens": 192,
    "temperature": 0.7,
    "top_p": 0.9,
    "style_tokens": []
  },
  "eval": {
    "eqbench_enabled": true,
    "eqbench_dataset_id": "pbevan11/EQ-Bench",
    "eqbench_split": "validation",
    "qualitative_prompts_path": "prompts/qualitative_prompts.jsonl",
    "redteam_prompts_path": "prompts/redteam_prompts.jsonl"
  }
}
